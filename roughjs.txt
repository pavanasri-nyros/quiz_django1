const options = document.querySelector(".options").children;
const answerTrackerContainer = document.querySelector(".answers-tracker");
const questionNumberSpan=document.querySelector(".question-num-value");
const totalQuestionSpan=document.querySelector(".total-question");
const correctAnswerSpan = document.querySelector(".correct-answers");
const totalQuestionSpan2 = document.querySelector(".total-questions2");
const percentage = document.querySelector(".percentage");


var question = document.querySelector(".question");
const op1 = document.querySelector(".option1");
const op2 = document.querySelector(".option2");
const op3 = document.querySelector(".option3");
const op4 = document.querySelector(".option4");
const answer = document.querySelector(".answer");
let questionIndex;
let index = 1;
var questions = [];
let myArray =[];
let myArr = [];
let score = 0;

  $.ajax({
    url: 'http://127.0.0.1:8000/api/?format=json',
    type:'GET',
    async:true,
    dataType: "json", 
    success: function(data)
     { 
        questions = data ;
     }
  });


    // var questions;
    // fetch('http://127.0.0.1:8000/api/?format=json')
    // .then(res => res.json())
    // .then(data => questions = data)
    // .then(() => console.log(questions))

totalQuestionSpan.innerHTML = questions.length;
function load(){
    questionNumberSpan.innerHTML = index + 1;
    question.innerHTML = questions[questionIndex].question;
    op1.innerHTML = questions[questionIndex].option1;
    op2.innerHTML = questions[questionIndex].option2;
    op3.innerHTML = questions[questionIndex].option3;
    op4.innerHTML = questions[questionIndex].option4;
    index++;
  }

  function check(element){
    //console.log(element.id);
    if(element.id == questions[questionIndex].answer){
      //correct
      element.classList.add("correct");
      updateAnswerTracker("correct")
      score++;

    }
    else{
      //wrong
      element.classList.add("wrong");
      updateAnswerTracker("wrong")
    }
    
    disabledOptions()
  }

  function disabledOptions(){
    for(let i =0;i<options.length;i++){
      options[i].classList.add("disabled");
      if(options[i].id== questions[questionIndex].answer){
        options[i].classList.add("correct");
      }
    }
  }

  function enableOptions(){
    for(let i =0;i<options.length;i++){
      options[i].classList.remove("disabled","correct","wrong");
     
    }
  }

  function validate(){
    if(!options[0].classList.contains("disabled")){
      alert("pleases select one option")

    }
    else{
      randomQuestion();
      enableOptions();
    }

  }
  function next(){
    validate();
  }

  function randomQuestion(){
    let randomNumber = Math.floor(Math.random()*question.length);
    let hitDuplicate=0;
        if(index == question.length){
          quizOver();
                }
        else{
          if(myArray.length>0){
            for(let i=0;i<myArray.length; i++){
              if(myArray[i]==randomNumber){
                hitDuplicate=1;
                break;
              }

            }
            if(hitDuplicate==1){
              randomQuestion();
            }
            else{
              questionIndex=randomNumber;
              load();
            }

          }
          if(myArray.length==0){
            questionIndex=randomNumber;
            load();
            myarr.push(questionIndex);
          }
        myArray.push(randomNumber);
        
        }
  }

  function answerTracker(){
    for(let i = 0; i<questions.length;i++)
    {
      const div = document.createElement("div")
      answerTrackerContainer.appendChild(div);

    }

  }
  function updateAnswerTracker(classNam){
    answerTrackerContainer.children[index-1].classList.add(classNam)

  }
  function quizOver(){
    document.querySelector(".quiz-over").classList.add("show");
    correctAnswerSpan.innerHTML=score;
    totalQuestionSpan2.innerHTML = questions.length;
    percentage.innerHTML=(score/questions.length)*100 + "%";

  }
  
  function tryAgain(){
    window.location.reload();
  }
  window.load = function(){
      randomQuestion()
      answerTracker()
  }
-------------------------------------------------------------------------

const questionNumberSpan=document.querySelector(".question-num-value");
const totalNumberSpan = document.querySelector(".total-question");
const totalQuestionSpan=document.querySelector(".total-question");

const answer = document.querySelector(".answer");
let questionIndex = 0;
let index = 1;
var questions = [];
  $.ajax({
    url: 'http://127.0.0.1:8002/api/?format=json',
    type:'GET',
    async:true,
    dataType: "json",
    success: function(data)
     {
        questions = data ;
        load();
     }
  });
function load(){
  const question = document.querySelector(".question");
const op1 = document.querySelector(".option1");
const op2 = document.querySelector(".option2");
const op3 = document.querySelector(".option3");
const op4 = document.querySelector(".option4");
    //questionIndex = 0;
    question.innerHTML = questions[questionIndex].question;
    op1.innerHTML = questions[questionIndex].option1;
    op2.innerHTML = questions[questionIndex].option2;
    op3.innerHTML = questions[questionIndex].option3;
    op4.innerHTML = questions[questionIndex].option4;
    console.log("questions")
  }
  ----------------------------------------------------------------l;l;
  let questionIndex = 0;
let index = 0;
var questions = [];

//Ajax call
  $.ajax({
    url: 'http://127.0.0.1:8002/api/?format=json',
    type:'GET',
    async:true,
    dataType: "json",
    success: function(data)
     {
        questions = data ;
        randomQuestion();        
     }
  });

//displays the questions and options
function load(){
    const questionNumberSpan=document.querySelector(".question-num-value");
    const totalQuestionSpan=document.querySelector(".total-question");
    const question = document.querySelector(".question");
    const op1 = document.querySelector(".option1");
    const op2 = document.querySelector(".option2");
    const op3 = document.querySelector(".option3");
    const op4 = document.querySelector(".option4");
    totalQuestionSpan.innerHTML=questions.length;
    questionNumberSpan.innerHTML=index+1;
    question.innerHTML = questions[questionIndex].question;
    op1.innerHTML = questions[questionIndex].option1;
    op2.innerHTML = questions[questionIndex].option2;
    op3.innerHTML = questions[questionIndex].option3;
    op4.innerHTML = questions[questionIndex].option4;
    index++;
  }


  
  //check the answer with the options
  const answer = document.querySelector(".answer");
  function check(){
    
    if((questions[questionIndex].option1 && questions[questionIndex].option2 && questions[questionIndex].option3 && questions[questionIndex].option4) == questions[questionIndex].correct_answer)
    {
      
    }  
    else{
           questions.classList.add("correct");

    }
  }
 
  function check(element){  
    var element = (questions[questionIndex].option1);
    if(element == questions[questionIndex].correct_answer){

    }
    else{
      element.add("correct");
    }
  }

  function randomQuestion(){
    // let randomNumber=Math.floor(Math.random()*questions.length);
    // questionIndex=randomNumber;
    console.log(questionIndex);
    load();
  }
  
 function check(radio) {
  resetColor();
    if (radio.checked) {
      if (questions[currentQuestion].correct_answer == radio.value) {
        radio.parentNode.style.backgroundColor = "green";
      } else {
        radio.parentNode.style.backgroundColor = "red";
      }
    } else {
      radio.parentNode.style.backgroundColor = "white";
    }
  }
  function showCorrect() {
  let options = document.querySelectorAll("input[name=option]");
  for (let i = 0; i < options.length; ++i) {
    if (parseInt(options[i].value) === Answers[CurrentQuestion - 1]) {
      options[i].parentNode.style.backgroundColor = "green";
    }
    options[i].setAttribute("disabled", "true");
  }
}
----------------------------------------


function check(radio) {
  resetColor();
    if (radio.checked) {
      if (questions[currentQuestion].correct_answer == radio.value) {
        radio.parentNode.style.backgroundColor = "green";
      } else {
        radio.parentNode.style.backgroundColor = "red";
      }
    } else {
      radio.parentNode.style.backgroundColor = "white";
    }
  }
  
  
  function resetColor() {
    let options = document.querySelectorAll("input[name=option]");
    for (let i = 0; i < options.length; ++i) {
      options[i].parentNode.style.background = "none";
    }
  }
